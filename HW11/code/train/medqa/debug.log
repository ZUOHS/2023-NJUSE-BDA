2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_setup.py:_flush():76] Current SDK version is 0.15.12
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_setup.py:_flush():76] Configure stats pid to 1263
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_setup.py:_flush():76] Loading settings from /root/autodl-tmp/dragon/wandb/settings
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'dragon.py', 'program_abspath': '/root/autodl-tmp/dragon/dragon.py', 'program': 'dragon.py'}
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_init.py:_log_setup():528] Logging user logs to /root/autodl-tmp/dragon/wandb/run-20231011_102450-x3bzwtzu/logs/debug.log
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_init.py:_log_setup():529] Logging internal logs to /root/autodl-tmp/dragon/wandb/run-20231011_102450-x3bzwtzu/logs/debug-internal.log
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_init.py:init():568] calling init triggers
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_init.py:init():575] wandb.init called with sweep_config: {}
config: {'ent_emb_paths': ['data/umls/ent_emb_blbertL.npy'], 'kg_vocab_path': 'data/umls/concepts.txt', 'dataset': 'medqa', 'data_dir': 'data', 'inhouse': False, 'inhouse_train_qids': 'data/medqa/inhouse_split_qids.txt', 'train_statements': 'data/medqa/statement/train.statement.jsonl', 'dev_statements': 'data/medqa/statement/dev.statement.jsonl', 'test_statements': 'data/medqa/statement/test.statement.jsonl', 'max_seq_len': 512, 'encoder': 'michiyasunaga/BioLinkBERT-large', 'encoder_load_path': '', 'encoder_layer': -1, 'encoder_lr': 2e-05, 'loss': 'cross_entropy', 'optim': 'radam', 'lr_schedule': 'warmup_linear', 'batch_size': 128, 'warmup_steps': 500.0, 'max_grad_norm': 1.0, 'weight_decay': 0.01, 'n_epochs': 30, 'max_epochs_before_stop': 100, 'log_interval': 10, 'cuda': True, 'seed': 5, 'debug': False, 'mode': 'train', 'use_codalab': 0, 'save_dir': 'runs/medqa/dragon__medqa_ih_false_load__elr2e-5_dlr1e-4_b128_ufz0_e30_sd5__20231011_102446', 'save_model': 0.0, 'load_model_path': 'models/biomed_model.pt', 'run_name': 'dragon__medqa_ih_false_load__elr2e-5_dlr1e-4_b128_ufz0_e30_sd5__20231011_102446', 'resume_checkpoint': 'None', 'use_wandb': True, 'resume_id': 'None', 'load_graph_cache': True, 'dump_graph_cache': True, 'local_rank': -1, 'world_size': 1, 'data_loader_one_process_at_a_time': False, 'end_task': 1.0, 'mlm_task': 0.0, 'link_task': 0.0, 'mlm_probability': 0.15, 'span_mask': False, 'link_drop_max_count': 100, 'link_drop_probability': 0.2, 'link_drop_probability_in_which_keep': 0.2, 'link_negative_sample_size': 64, 'link_negative_adversarial_sampling': True, 'link_negative_adversarial_sampling_temperature': 1, 'link_regularizer_weight': 0.01, 'link_normalize_headtail': 0, 'link_proj_headtail': False, 'scaled_distmult': False, 'link_gamma': 12, 'link_decoder': 'DistMult', 'kg': 'umls', 'max_num_relation': -1, 'kg_only_use_qa_nodes': False, 'train_adj': 'data/medqa/graph/train.graph.adj.pk', 'dev_adj': 'data/medqa/graph/dev.graph.adj.pk', 'test_adj': 'data/medqa/graph/test.graph.adj.pk', 'max_node_num': 200, 'subsample': 1.0, 'n_train': -1, 'k': 5, 'att_head_num': 2, 'gnn_dim': 200, 'fc_dim': 200, 'fc_layer_num': 0, 'freeze_ent_emb': True, 'ie_dim': 400, 'residual_ie': 2, 'info_exchange': True, 'ie_layer_num': 1, 'sep_ie_layers': False, 'random_ent_emb': False, 'cxt_node_connects_all': False, 'no_node_score': True, 'dropouti': 0.2, 'dropoutg': 0.2, 'dropoutf': 0.2, 'decoder_lr': 0.0001, 'mini_batch_size': 1, 'eval_batch_size': 2, 'unfreeze_epoch': 0, 'refreeze_epoch': 10000, 'init_range': 0.02, 'fp16': True, 'upcast': True, 'redef_epoch_steps': -1, 'hf_version': '4.9.1', 'wandb_id': 'x3bzwtzu'}
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_init.py:init():618] starting backend
2023-10-11 10:24:50,944 INFO    MainThread:1263 [wandb_init.py:init():622] setting up manager
2023-10-11 10:24:50,946 INFO    MainThread:1263 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: fork
2023-10-11 10:24:50,949 INFO    MainThread:1263 [wandb_init.py:init():628] backend started and connected
2023-10-11 10:24:50,953 INFO    MainThread:1263 [wandb_init.py:init():720] updated telemetry
2023-10-11 10:24:50,974 INFO    MainThread:1263 [wandb_init.py:init():753] communicating run to backend with 90.0 second timeout
2023-10-11 10:24:52,460 INFO    MainThread:1263 [wandb_run.py:_on_init():2220] communicating current version
2023-10-11 10:24:53,198 INFO    MainThread:1263 [wandb_run.py:_on_init():2229] got version response 
2023-10-11 10:24:53,199 INFO    MainThread:1263 [wandb_init.py:init():804] starting run threads in backend
2023-10-11 10:24:55,223 INFO    MainThread:1263 [wandb_run.py:_console_start():2199] atexit reg
2023-10-11 10:24:55,224 INFO    MainThread:1263 [wandb_run.py:_redirect():2054] redirect: wrap_raw
2023-10-11 10:24:55,224 INFO    MainThread:1263 [wandb_run.py:_redirect():2119] Wrapping output streams.
2023-10-11 10:24:55,224 INFO    MainThread:1263 [wandb_run.py:_redirect():2144] Redirects installed.
2023-10-11 10:24:55,225 INFO    MainThread:1263 [wandb_init.py:init():845] run started, returning control to user process
2023-10-12 08:32:44,346 WARNING MsgRouterThr:1263 [router.py:message_loop():77] message_loop has been closed
